<span class="builtin">import</span> geometry; <span class="function-name">size</span>(10<span class="constant">cm</span>,0);
<span class="type">triangle</span> <span class="variable-name">t</span>=<span class="function-name">triangleabc</span>(5,6,7); <span class="function-name">draw</span>(t, <span class="function-name">linewidth</span>(<span class="constant">bp</span>));
<span class="type">point</span> <span class="variable-name">P</span>=0.5*t.B+0.3*(t.C-t.B); <span class="function-name">dot</span>(<span class="string">"$P$"</span>, P, <span class="constant">N</span>, 0.8*<span class="constant">red</span>);

<span class="type">point</span> <span class="variable-name">Q</span>=<span class="function-name">isogonalconjugate</span>(t,P); <span class="function-name">dot</span>(<span class="string">"$Q$"</span>, Q, <span class="function-name">dir</span>(-30));
<span class="type">point</span> <span class="variable-name">Q1</span>=<span class="function-name">projection</span>(t.AB)*Q; <span class="type">segment</span> <span class="variable-name">sq1</span>=<span class="function-name">segment</span>(Q,Q1);
<span class="type">point</span> <span class="variable-name">Q2</span>=<span class="function-name">projection</span>(t.BC)*Q; <span class="type">segment</span> <span class="variable-name">sq2</span>=<span class="function-name">segment</span>(Q,Q2);
<span class="type">point</span> <span class="variable-name">Q3</span>=<span class="function-name">projection</span>(t.AC)*Q; <span class="type">segment</span> <span class="variable-name">sq3</span>=<span class="function-name">segment</span>(Q,Q3);
<span class="function-name">draw</span>(sq1); <span class="function-name">draw</span>(sq2); <span class="function-name">draw</span>(sq3);
<span class="function-name">dot</span>(<span class="string">"$Q_1$"</span>, Q1, <span class="constant">SE</span>); <span class="function-name">dot</span>(<span class="string">"$Q_2$"</span>, Q2); <span class="function-name">dot</span>(<span class="string">"$Q_3$"</span>, Q3, <span class="constant">NW</span>);

<span class="type">point</span> <span class="variable-name">P1</span>=<span class="function-name">projection</span>(t.AB)*P; <span class="type">segment</span> <span class="constant">sp</span>1=<span class="function-name">segment</span>(P,P1);
<span class="type">point</span> <span class="variable-name">P2</span>=<span class="function-name">projection</span>(t.BC)*P; <span class="type">segment</span> <span class="constant">sp</span>2=<span class="function-name">segment</span>(P,P2);
<span class="type">point</span> <span class="variable-name">P3</span>=<span class="function-name">projection</span>(t.AC)*P; <span class="type">segment</span> <span class="constant">sp</span>3=<span class="function-name">segment</span>(P,P3);
<span class="function-name">draw</span>(<span class="constant">sp</span>1, 0.8*<span class="constant">red</span>); <span class="function-name">draw</span>(<span class="constant">sp</span>2, 0.8*<span class="constant">red</span>); <span class="function-name">draw</span>(<span class="constant">sp</span>3, 0.8*<span class="constant">red</span>);
<span class="function-name">dot</span>(<span class="string">"$P_1$"</span>,P1,<span class="constant">SW</span>,0.8*<span class="constant">red</span>); <span class="function-name">dot</span>(<span class="string">"$P_2$"</span>,P2,0.8*<span class="constant">red</span>); <span class="function-name">dot</span>(<span class="string">"$P_3$"</span>,P3,<span class="constant">NW</span>,0.8*<span class="constant">red</span>);

<span class="function-name">perpendicularmark</span>(t.AB,sq1); <span class="function-name">perpendicularmark</span>(t.BC,sq2);
<span class="function-name">perpendicularmark</span>(<span class="function-name">reverse</span>(t.AC),sq3); <span class="function-name">perpendicularmark</span>(t.AB,<span class="constant">sp</span>1, <span class="constant">red</span>);
<span class="function-name">perpendicularmark</span>(t.BC,<span class="constant">sp</span>2, <span class="constant">red</span>); <span class="function-name">perpendicularmark</span>(<span class="function-name">reverse</span>(t.AC),<span class="constant">sp</span>3, <span class="constant">red</span>);

<span class="type">circle</span> <span class="variable-name">C</span>=<span class="function-name">circle</span>(Q1,Q2,Q3); <span class="function-name">draw</span>(C, 0.8*<span class="constant">blue</span>);
<span class="function-name">draw</span>(<span class="function-name">segment</span>(Q,P), 0.8*<span class="constant">blue</span>, <span class="function-name">StickIntervalMarker</span>(2,2, 0.8*<span class="constant">blue</span>));
<span class="function-name">dot</span>(<span class="string">"$C$"</span>, C.C, <span class="constant">S</span>, 0.8*<span class="constant">blue</span>);

