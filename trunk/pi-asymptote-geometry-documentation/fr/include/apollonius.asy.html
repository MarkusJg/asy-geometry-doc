<span class="builtin">import</span> geometry;
<span class="function-name">size</span>(9.5<span class="constant">cm</span>,0); <span class="function-name">usepackage</span>(<span class="string">"mathrsfs"</span>); <span class="constant">currentpen</span>=<span class="function-name">fontsize</span>(8); <span class="type">pen</span> <span class="variable-name">bpp</span>=<span class="function-name">linewidth</span>(<span class="constant">bp</span>);
<span class="type">circle</span> <span class="variable-name">C1</span>=<span class="function-name">circle</span>((0,0),2), <span class="variable-name">C2</span>=<span class="function-name">circle</span>((5,5), 3), <span class="variable-name">C3</span>=<span class="function-name">circle</span>((6,-2),1);
<span class="function-name">draw</span>(<span class="function-name">Label</span>(<span class="string">"$\mathscr{C}_1$"</span>,<span class="function-name">Relative</span>(0.375)), C1, <span class="constant">bp</span>+0.8*<span class="constant">red</span>);
<span class="function-name">draw</span>(<span class="string">"$\mathscr{C}_2$"</span>, C2, <span class="constant">bp</span>+0.8*<span class="constant">red</span>);
<span class="function-name">dot</span>(C1.C, 0.8*<span class="constant">red</span>); <span class="function-name">dot</span>(C2.C, 0.8*<span class="constant">red</span>); <span class="function-name">dot</span>(C3.C, 0.8*<span class="constant">red</span>);
<span class="type">inversion</span> <span class="constant">S</span>1=<span class="function-name">inversion</span>(C2,C3), <span class="constant">S</span>2=<span class="function-name">inversion</span>(C1,C3);
<span class="function-name">dot</span>(<span class="string">"$S_1$"</span>, <span class="constant">S</span>1.C, 2<span class="constant">S</span>+<span class="constant">W</span>); <span class="function-name">dot</span>(<span class="string">"$S_2$"</span>, <span class="constant">S</span>2.C, 2<span class="constant">S</span>);
<span class="type">line</span> <span class="variable-name">cl</span>=<span class="function-name">line</span>(<span class="constant">S</span>1.C,<span class="constant">S</span>2.C); <span class="function-name">draw</span>(cl);
<span class="type">point</span> <span class="constant">M</span>=<span class="function-name">relpoint</span>(C3,0.125), <span class="constant">M</span>2=<span class="constant">S</span>2*<span class="constant">M</span>, <span class="constant">M</span>1=<span class="constant">S</span>1*<span class="constant">M</span>;
<span class="function-name">dot</span>(<span class="string">"$M$"</span>, <span class="constant">M</span>, 2*<span class="constant">E</span>); <span class="function-name">dot</span>(<span class="string">"$M_2$"</span>, <span class="constant">M</span>2, <span class="constant">NW</span>); <span class="function-name">dot</span>(<span class="string">"$M_1$"</span>, <span class="constant">M</span>1, 2*<span class="function-name">dir</span>(-10));
<span class="function-name">draw</span>(<span class="function-name">segment</span>(<span class="constant">S</span>2.C,<span class="constant">M</span>2), <span class="constant">dashed</span>+<span class="constant">grey</span>); <span class="function-name">draw</span>(<span class="function-name">segment</span>(<span class="constant">S</span>1.C,<span class="constant">M</span>1), <span class="constant">dashed</span>+<span class="constant">grey</span>);
<span class="type">circle</span> <span class="variable-name">C</span>=<span class="function-name">circle</span>(<span class="constant">M</span>,<span class="constant">M</span>2,<span class="constant">M</span>1);
<span class="function-name">draw</span>(<span class="function-name">Label</span>(<span class="string">"$\mathscr{C}$"</span>, <span class="function-name">Relative</span>(0.375)), C, <span class="constant">lightblue</span>);
<span class="type">line</span> <span class="variable-name">L</span>=<span class="function-name">radicalline</span>(C,C3); <span class="function-name">draw</span>(<span class="string">"$(d)$"</span>, L, <span class="constant">grey</span>);
<span class="type">point</span> <span class="variable-name">H</span>=<span class="function-name">intersectionpoint</span>(L,cl); <span class="function-name">dot</span>(<span class="string">"$H$"</span>, H, 2*<span class="function-name">dir</span>(260));
<span class="type">circle</span> <span class="variable-name">Cp</span>=<span class="function-name">circle</span>(H,C3.C);
<span class="function-name">clipdraw</span>(<span class="function-name">Label</span>(<span class="string">"$\mathscr{C'}$"</span>, <span class="function-name">Relative</span>(0.9)), Cp, <span class="constant">lightblue</span>);
<span class="type">point</span>[] T=<span class="function-name">intersectionpoints</span>(Cp,C3);
<span class="type">point</span>[][] Tp= <span class="builtin">new</span> <span class="type">point</span>[][] {{<span class="constant">S</span>2*T[0], <span class="constant">S</span>1*T[0]},{<span class="constant">S</span>2*T[1], <span class="constant">S</span>1*T[1]}};
<span class="function-name">draw</span>(<span class="constant">S</span>2.C--Tp[0][0], <span class="constant">dashed</span>+<span class="constant">grey</span>); <span class="function-name">draw</span>(<span class="constant">S</span>1.C--Tp[0][1], <span class="constant">dashed</span>+<span class="constant">grey</span>);
<span class="function-name">draw</span>(<span class="constant">S</span>2.C--Tp[1][0], <span class="constant">dashed</span>+<span class="constant">grey</span>); <span class="function-name">draw</span>(<span class="constant">S</span>1.C--Tp[1][1], <span class="constant">dashed</span>+<span class="constant">grey</span>);
<span class="function-name">dot</span>(<span class="function-name">Label</span>(<span class="string">"$T_0$"</span>,<span class="constant">UnFill</span>), T[0], 2*<span class="function-name">dir</span>(-20));
<span class="function-name">dot</span>(<span class="function-name">Label</span>(<span class="string">"$T_1$"</span>,<span class="constant">UnFill</span>), T[1], <span class="constant">W</span>);
<span class="function-name">dot</span>(<span class="string">"$T''_0$"</span>, <span class="type">Tp</span>[0][0], <span class="constant">SW</span>); <span class="function-name">dot</span>(<span class="string">"$T'_0$"</span>, <span class="type">Tp</span>[0][1], <span class="constant">NE</span>);
<span class="function-name">dot</span>(<span class="string">"$T''_1$"</span>, <span class="type">Tp</span>[1][0], <span class="constant">W</span>); <span class="function-name">dot</span>(<span class="string">"$T'_1$"</span>, <span class="type">Tp</span>[1][1], <span class="constant">N</span>);
<span class="function-name">draw</span>(<span class="function-name">Label</span>(<span class="string">"$\mathscr{T}_0$"</span>, <span class="function-name">Relative</span>(0.375)), <span class="function-name">circle</span>(T[0],<span class="type">Tp</span>[0][0],<span class="type">Tp</span>[0][1]), bpp);
<span class="function-name">draw</span>(<span class="function-name">Label</span>(<span class="string">"$\mathscr{T}_1$"</span>, <span class="function-name">Relative</span>(0.375)), <span class="function-name">circle</span>(T[1],<span class="type">Tp</span>[1][0],<span class="type">Tp</span>[1][1]), bpp);
<span class="function-name">draw</span>(<span class="function-name">Label</span>(<span class="string">"$\mathscr{C}_3$"</span>,<span class="function-name">Relative</span>(0.625),<span class="constant">UnFill</span>), C3, <span class="constant">bp</span>+0.8*<span class="constant">red</span>);

